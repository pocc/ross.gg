{{ if or (eq .Section "essays") (eq .Section "notes") }}
{{ if .IsPage }}
<div class="reading-progress" aria-hidden="true">
  <div class="reading-progress-bar" id="reading-progress"></div>
</div>
<script>
  (function() {
    var bar = document.getElementById('reading-progress');
    if (!bar) return;
    var article = document.querySelector('article') || document.querySelector('main');
    if (!article) return;
    function update() {
      var rect = article.getBoundingClientRect();
      var total = rect.height - window.innerHeight;
      if (total <= 0) { bar.style.width = '100%'; return; }
      var progress = Math.min(Math.max(-rect.top / total, 0), 1);
      bar.style.width = (progress * 100) + '%';
    }
    var ticking = false;
    window.addEventListener('scroll', function() {
      if (!ticking) {
        requestAnimationFrame(function() { update(); ticking = false; });
        ticking = true;
      }
    }, { passive: true });
    update();
  })();
</script>
{{ end }}
{{ end }}
