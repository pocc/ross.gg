{{ define "main" }}
<article class="max-w-3xl mx-auto px-4 sm:px-6 py-12">
  <header class="mb-8">
    {{ with .Params.cover }}
    <img src="{{ . }}" alt="{{ $.Title }}" class="w-full rounded-card mb-6" loading="lazy">
    {{ end }}
    <h1 class="font-display text-4xl font-bold mb-4" style="letter-spacing: -0.02em;">{{ .Title }}</h1>
    <div class="flex flex-wrap items-center gap-4 text-sm" style="color: var(--fg-muted);">
      <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "January 2, 2006" }}</time>
      <span>&middot;</span>
      <span>{{ .WordCount }} words</span>
      <span>&middot;</span>
      <span>{{ .ReadingTime }} min read</span>
      {{ with .Params.series }}
      <span>&middot;</span>
      <span style="color: var(--accent);">{{ . }}</span>
      {{ end }}
    </div>
  </header>

  {{ if and .Params.toc (gt .WordCount 600) }}
  <nav class="bento-card mb-8 text-sm">
    <span class="card-label">Contents</span>
    {{ .TableOfContents }}
  </nav>
  {{ end }}

  <div class="prose prose-lg max-w-none">
    {{ .Content }}
  </div>

  {{ with .Params.tags }}
  <div class="mt-8 pt-6 flex flex-wrap gap-2" style="border-top: 1px solid var(--card-border);">
    {{ range . }}
    <a href="/tags/{{ . | urlize }}/" class="stage-badge stage-evergreen hover:opacity-80 transition-opacity">{{ . }}</a>
    {{ end }}
  </div>
  {{ end }}

  {{ partial "backlinks.html" $ }}
</article>
{{ end }}
